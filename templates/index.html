<!DOCTYPE html>
<html>
<head>
    <title>FarmKart</title>
    <link rel="stylesheet" href="/static/css/style.css">

    <script>
        function toggleDark() {
            document.body.classList.toggle("dark");
            localStorage.setItem("theme",
                document.body.classList.contains("dark") ? "dark" : "light");
        }
        window.onload = function () {
            if (localStorage.getItem("theme") === "dark") {
                document.body.classList.add("dark");
            }
        };
    </script>
</head>
<body>

<nav>
    <h1>ğŸŒ± FarmKart</h1>
    <div>
        <a href="/">Home</a>
        {% if session.get("user_id") %}
            <a href="/dashboard">Dashboard</a>
            {% if session.get("role") == "consumer" %}
                <a href="/cart">Cart</a>
            {% endif %}
            <a href="/logout">Logout</a>
        {% else %}
            <a href="/login">Login</a>
            <a href="/register">Register</a>
        {% endif %}
        <span class="toggle" onclick="toggleDark()">ğŸŒ™</span>
    </div>
</nav>

<div class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="flash flash-{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}
</div>

<section class="hero">
    <h2>Fresh from Farm. Direct to You.</h2>
    <p>No middlemen. Only freshness.</p>
</section>

<div class="container">
    <div class="products">
        {% for p in products %}
        <div class="card">
            <span class="badge">ğŸ‘¨â€ğŸŒ¾ Farmer</span>
            <h3>{{ p.name }}</h3>
            <p>â‚¹ {{ p.price }}</p>
            <p>Stock: {{ p.quantity }}</p>
            <p>By {{ p.farmer_name }}</p>

            {% if session.get("role") == "consumer" and p.quantity > 0 %}
            <a href="/add_to_cart/{{ p.id }}">
                <button>Add to Cart</button>
            </a>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>

</body>
</html>
